<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>技能 SKILLS - 馬茲提卡</title>

  <!-- 模組 -->
  <link rel="stylesheet" href="navbar.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script defer src="navbar.js"></script>
  <link rel="stylesheet" href="background.css">
  <script defer src="background.js"></script>

  <!-- 字型 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/quatl" rel="stylesheet">

  <style>
    :root{
      --gold:#c9a35a;
      --gold-bright:#ffd966; /* 更偏金的亮光 */
      --jade:#0e4b3a;
      --paper:#f1e8d6;
      /* 次導覽主題色 */
      --str:#e63946; /* 力量-紅 */
      --dex:#2e7d32; /* 敏捷-綠 */
      --int:#3f7ebe; /* 智力-藍 */
      --cha:#ff77aa; /* 魅力-粉 */
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Noto Sans TC',sans-serif;color:#f1e8d6;overflow-x:hidden;}

    header{padding:40px 40px 0;opacity:0;transform:translateY(-30px);}
    header h1{font-family:"Quatl",serif;font-size:2rem;color:var(--gold);letter-spacing:2px;}
    header p{margin-top:8px;font-size:1.05rem;color:#fffbe8;line-height:1.7;}

    .divider{width:100%;height:80px;background:url('images/aztec-divider.png') repeat-x;background-size:auto 200%;opacity:.9;}

    main{
      max-width:1200px;margin:30px auto;padding:0 32px 60px;
      background:rgba(0,0,0,.25);border:1px solid var(--gold);border-radius:12px;
      box-shadow:0 4px 10px rgba(0,0,0,.5);backdrop-filter:blur(3px);opacity:0;
    }

    h2,h3{color:var(--gold);margin-top:1.2em;margin-bottom:.6em;}
    p,li{line-height:1.8;margin-bottom:10px;}
    ul{margin-left:20px;}

    /* 上層分頁（檢定規則／技能介紹） */
    .gear-tabs{display:flex;justify-content:center;gap:8px;margin:20px 0 25px;flex-wrap:wrap;opacity:0;}
    .tab-btn{
      background:rgba(20,20,20,.8);color:var(--gold);border:1px solid var(--gold);
      border-radius:6px;padding:8px 16px;font-size:15px;cursor:pointer;
      transition:.25s;position:relative;overflow:hidden;letter-spacing:1px;
    }
    .tab-btn::before{
      content:"";position:absolute;inset:0;transform:translateX(-100%);
      background:linear-gradient(120deg,transparent,rgba(255,217,102,.45),transparent);
      transition:.5s;
    }
    .tab-btn:hover::before{transform:translateX(100%);}
    .tab-btn:hover{color:#fff8cc;box-shadow:0 0 10px var(--gold-bright);}
    .tab-btn.active{
      background:rgba(255,217,102,.15);color:#fff9d9;border-color:var(--gold-bright);
      box-shadow:0 0 12px rgba(255,217,102,.7);
    }

    /* 內容區塊 */
    .text-block{
      background:rgba(0,0,0,.3);border:1px solid var(--gold);border-radius:8px;
      padding:16px 20px;margin:20px 0;box-shadow:0 0 8px rgba(0,0,0,.3);
    }

    /* 分頁顯示/隱藏（修正重疊） */
    .tab-content{display:none;opacity:0;transition:opacity .35s ease;}
    .tab-content.active{display:block;opacity:1;}

    /* 技能介紹：分組標題 */
    .group-title{
      background:rgba(255,217,102,.12);border:1px solid var(--gold-bright);
      border-radius:6px;padding:10px 16px;font-weight:700;color:var(--gold-bright);
      cursor:pointer;margin:10px 0;text-align:center;transition:.3s;
    }
    .group-title:hover{background:rgba(255,217,102,.2);box-shadow:0 0 10px rgba(255,217,102,.6);}

    /* 技能按鈕列 */
    .skill-tabs{display:none;flex-wrap:wrap;justify-content:center;gap:10px;margin:12px 0 18px;}
    .skill-tabs.active{display:flex;}

    .skill-btn{
      border-radius:6px;padding:6px 14px;cursor:pointer;font-weight:600;transition:.2s;border:1px solid;
      color:#fff; /* 與主題色對比 */
    }
    /* 主題色：力量/敏捷/智力/魅力 */
    .btn-str{background:rgba(230,57,70,.18);border-color:var(--str);}
    .btn-str:hover,.btn-str.active{background:rgba(230,57,70,.36);box-shadow:0 0 10px rgba(230,57,70,.6);}

    .btn-dex{background:rgba(46,125,50,.18);border-color:var(--dex);}
    .btn-dex:hover,.btn-dex.active{background:rgba(46,125,50,.36);box-shadow:0 0 10px rgba(46,125,50,.6);}

    .btn-int{background:rgba(63,126,190,.18);border-color:var(--int);}
    .btn-int:hover,.btn-int.active{background:rgba(63,126,190,.36);box-shadow:0 0 10px rgba(63,126,190,.6);}

    .btn-cha{background:rgba(255,119,170,.18);border-color:var(--cha);}
    .btn-cha:hover,.btn-cha.active{background:rgba(255,119,170,.36);box-shadow:0 0 10px rgba(255,119,170,.6);}
  </style>
</head>
<body>
  <div id="site-navbar"></div>

  <header>
    <h1>技能 SKILLS</h1>
    <p>技能代表你在作為冒險者期間（或之前）所獲得的知識和能力。它們決定了你在遊戲中執行行動的效率。</p>
  </header>

  <div class="divider"></div>

  <main id="content">
    <!-- 上層分頁 -->
    <nav class="gear-tabs">
      <button class="tab-btn" data-tab="check" id="btn-check">檢定規則</button>
      <button class="tab-btn active" data-tab="skill" id="btn-skill">技能介紹</button>
    </nav>

    <!-- 技能介紹（預設顯示） -->
    <section class="tab-content active" id="skill">
      <div class="text-block" style="margin-top:10px;">
        <h2>核心技能</h2>
      </div>

      <div id="skillGroups"></div>
      <div id="skillDetail" class="text-block"></div>
    </section>

    <!-- 檢定規則 -->
    <section class="tab-content" id="check">
      <div class="text-block">
        <h2>擲骰檢定</h2>
        <ul>
          <li>當進行檢定時，描述你角色想要達成的事情，然後骰 1D20。</li>
          <li>若擲骰結果 ≦ 技能等級，檢定成功。
            <ul>
              <li>在戰鬥中檢定成功會有特定的效果。</li>
              <li>在戰鬥外，由 GM 或擲骰玩家決定檢定結果。</li>
            </ul>
          </li>
          <li>若擲骰結果 &gt; 技能等級，檢定失敗。
            <ul>
              <li>你沒有達成預期的目標，或是發生意想不到的事件，和 GM 一起發想結果。</li>
              <li>失敗不代表故事停滯，你可能仍然達成目標，但花了更多時間、有危險發生，或損失什麼東西。</li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="text-block">
        <h2>優勢 &amp; 劣勢</h2>
        <ul>
          <li>有時候，GM 會判斷有些額外因素會協助或妨礙你的檢定，這時候，你的檢定就會獲得<strong>優勢</strong>或<strong>劣勢</strong>。
            <ul>
              <li>若你的檢定擁有一個<strong>優勢</strong>，你骰 2D20，取較低的結果。</li>
              <li>若你的檢定擁有一個<strong>劣勢</strong>，你骰 2D20，取較高的結果。</li>
            </ul>
          </li>
        </ul>
        <h3>複數優勢 &amp; 複數劣勢</h3>
        <p>若你在一個檢定中擁有多個優勢或多個劣勢，每擁有一個優勢/劣勢就會額外 +1D20，然後全部一起擲骰，取最低或最高的結果。</p>

        <h3>同時擁有優勢和劣勢</h3>
        <ul>
          <li>若你在一個檢定中同時擁有優勢和劣勢，則倆倆互相抵消。
            <ul>
              <li>例如，你擁有一個優勢和一個劣勢，則互相抵消，正常擲骰。</li>
              <li>例如，你擁有兩個優勢和一個劣勢，則抵消之後，還剩一個優勢。</li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="text-block">
        <h2>強推檢定</h2>
        <ul>
          <li>若你檢定失敗，你可以選擇<strong>「強推檢定」</strong>，代表你可以重骰一次，並使用新的擲骰結果。
            <ul>
              <li>若你原本的檢定有優勢或劣勢，則強推檢定一樣會有優勢或劣勢。</li>
              <li>你不能強推骰出<strong>大失敗</strong>的檢定。</li>
            </ul>
          </li>
          <li>在你強推檢定後，你會獲得一個<strong>狀態</strong>，代表你基於該屬性的所有技能檢定都會獲得一個劣勢。每個狀態都與一個屬性連結，如下：
            <ul>
              <li>力竭（力量）</li>
              <li>虛弱（體質）</li>
              <li>暈眩（敏捷）</li>
              <li>憤怒（智力）</li>
              <li>畏縮（意志）</li>
              <li>沮喪（魅力）</li>
            </ul>
          </li>
          <li>由你自己決定獲得哪一個<strong>狀態</strong>，但有以下兩個條件：
            <ul>
              <li>你不能選擇你已經擁有的<strong>狀態</strong>。</li>
              <li>你必須解釋為什麼你的行動會獲得該<strong>狀態</strong>。</li>
            </ul>
          </li>
          <li>當你擁有所有六種<strong>狀態</strong>時，你就無法強推檢定。</li>
          <li>你可以藉由休息來恢復狀態。</li>
        </ul>
      </div>

      <div class="text-block">
        <h2>協助檢定</h2>
        <ul>
          <li>其他 PC 或 NPC 可以協助你進行檢定。協助必須在檢定前宣告，且必須在故事中合理呈現，協助者必須在你附近，且有能力提供幫助，由 GM 判定。</li>
          <li>若你獲得協助，你的檢定就會獲得一個優勢。</li>
          <li>在戰鬥中，協助他人是一個動作。</li>
          <li>同時只能有一個人對一個檢定進行協助。</li>
        </ul>
      </div>

      <div class="text-block">
        <h2>對抗檢定</h2>
        <ul>
          <li>有時候你必須在對抗檢定中贏過對手，才能在行動中獲得成功。只有當該行動明顯有人對抗你時，才會進行對抗檢定（在戰鬥中攻擊對方不算對抗檢定，而是有特定的戰鬥規則）。</li>
          <li>若要進行對抗檢定，雙方骰各自的技能檢定。
            <ul>
              <li>若主動方檢定失敗，無論對方擲骰結果如何，你的行動都會失敗。</li>
              <li>若主動方檢定成功，而對方檢定失敗，你的行動成功。</li>
              <li>若雙方都檢定成功，只要你的擲骰結果 ≦ 對方，你行動成功。若對方擲骰結果 &lt; 你，則你行動失敗。</li>
            </ul>
          </li>
        </ul>
        <p><strong>強推檢定：</strong>雙方都可以強推對抗檢定，甚至可以在對方擲骰後決定要不要強推。</p>
        <p><strong>公開對抗：</strong>若雙方都檢定失敗、或雙方都成功但骰到相同的結果，則必須<strong>重骰</strong>對抗。雙方一樣都可以強推檢定。</p>
      </div>
    </section>
  </main>

  <script>
  /* ====== 上層分頁：修正重疊，只顯示所選分頁 ====== */
  const mainTabs = document.querySelectorAll('.tab-btn');
  const pages = document.querySelectorAll('.tab-content');

  function showTab(id){
    // 清掉所有 active
    mainTabs.forEach(b=>b.classList.remove('active'));
    pages.forEach(sec=>{ sec.classList.remove('active'); sec.style.display='none'; });

    // 啟用目標分頁
    const btn = document.querySelector(`.tab-btn[data-tab="${id}"]`);
    const sec = document.getElementById(id);
    btn.classList.add('active');
    sec.classList.add('active');
    sec.style.display='block';
    gsap.fromTo(sec,{opacity:0},{opacity:1,duration:.35});
    window.scrollTo({top:0,behavior:'smooth'});
  }

  mainTabs.forEach(b=>{
    b.addEventListener('click',()=> showTab(b.dataset.tab));
  });

  // 預設顯示「技能介紹」
  showTab('skill');

  /* ====== 技能介紹資料（依你提供的內容補正） ====== */
  const data = {
    "力量技能":{
      theme:"str",
      items:[
        {name:"工藝（力量）", html:`
          <p>身為一名冒險者，你經常要自己修理損壞的裝備。通常來說，修理受損的物品需要耗時<strong>一班時間</strong>，且你必須擁有適合的工具。</p>
        `},
        {name:"武器技能（力量/敏捷）", html:`
          <p>揮舞不同的武器需要不同的武器技能。</p>
          <ul>
            <li><strong>徒手（力量）：</strong>用於拳腳、牙齒利爪等徒手格鬥。</li>
            <li><strong>斧（力量）：</strong>用於各式斧頭，包括投擲。</li>
            <li><strong>棍棒（力量）：</strong>用於棒類或其他鈍器。</li>
            <li><strong>矛（力量）：</strong>用於木矛、投射標槍等。</li>
            <li><strong>劍（力量）：</strong>用於各式刀劍。</li>
            <li><strong>小刀（敏捷）：</strong>用於小刀和匕首，包括投擲。</li>
            <li><strong>弓（敏捷）：</strong>用於各式弓類武器。</li>
            <li><strong>投槍器（力量）：</strong>用於投擲投射標槍或箭矢。</li>
            <li><strong>投石繩（敏捷）：</strong>用於投石繩。</li>
            <li><strong>吹箭筒（敏捷）：</strong>用於吹箭筒。</li>
          </ul>
        `}
      ]
    },
    "敏捷技能":{
      theme:"dex",
      items:[
        {name:"體操（敏捷）", html:`<p>當你嘗試跳躍、攀爬、維持平衡或執行類似的身體動作時，進行<strong>體操</strong>檢定。</p>`},
        {name:"閃避（敏捷）", html:`<p>當你嘗試閃避攻擊或逃離戰鬥時，進行<strong>閃避</strong>檢定。</p>`},
        {name:"狩獵（敏捷）", html:`<p>在野外時，你經常要透過狩獵來自己找到食物。</p>`},
        {name:"騎術（敏捷）", html:`<p>單純騎上馬匹或慢速騎乘不需要進行檢定，但若要執行更困難的特技就需要進行<strong>騎術</strong>檢定。</p>`},
        {name:"巧手（敏捷）", html:`<p>當你嘗試偷竊、開鎖，或其他需要精密操作的行動時，進行<strong>巧手</strong>檢定。</p>`},
        {name:"隱匿（敏捷）", html:`
          <p>有時候，躲起來避開戰鬥或悄悄通過敵人是更明智的做法。若你<strong>隱匿</strong>檢定成功，你不會被敵人發現。通常這只需要一般的技能檢定，但如果有人在主動尋找你，就需要用你的檢定來對抗敵人的<strong>察覺</strong>檢定。</p>
          <p>注意，只有當你能看見或聽見你想躲避的敵人時，才能嘗試檢定。你不能因為想防止「萬一」附近有敵人而進行檢定。</p>
        `},
        {name:"游泳（敏捷）", html:`<p>所有 PC 都可以在短時間內漂浮在水面上，但如果有更險峻的情勢就必須進行<strong>游泳</strong>檢定。</p>`}
      ]
    },
    "智力技能":{
      theme:"int",
      items:[
        {name:"察覺（智力）", html:`
          <p>身為一名冒險者，你必須隨時保持警惕。你使用<strong>察覺</strong>檢定來發現或聆聽在附近偷偷摸摸的人（對抗<strong>隱匿</strong>）。有時候 GM 會讓你進行被動式檢定來注意危險，這種檢定無法強推。</p>
          <p>若有多個 PC 在相同地點，<strong>察覺</strong>檢定只能各自進行，無法互相協助。</p>
        `},
        {name:"野獸知識（智力）", html:`<p>辨識動物或怪物、理解其習性、能力與弱點時進行<strong>野獸知識</strong>檢定；成功時 GM 應提供有用資訊。</p>`},
        {name:"求生（智力）", html:`<p>在荒野帶路、紮營、烹煮食物，或在寒冷天氣中保持溫暖時，進行<strong>求生</strong>檢定。</p>`},
        {name:"醫療（智力）", html:`<p>你可以用<strong>醫療</strong>檢定讓倒下的同伴再次站起來，甚至救治他們的生命。</p>`},
        {name:"語言（智力）", html:`<p>所有 PC 都會說通用語與閱讀簡單文字；若要理解外國或古老語言，進行<strong>語言</strong>檢定。</p>`},
        {name:"祕聞傳說（智力）", html:`<p>當你嘗試想起古老或遙遠地區的故事，或找出古往今來的連結，進行<strong>祕聞傳說</strong>檢定。</p>`},
        {name:"船藝（智力）", html:`<p>任何人都能慢慢划船，但在更險峻的情勢須進行<strong>船藝</strong>檢定來操作水上載具。</p>`},
        {name:"調查（智力）", html:`
          <p>當你嘗試尋找被隱藏起來的東西時，進行<strong>調查</strong>檢定。若你非常精確地描述你要找的地方，GM 可能給你優勢，甚至不需擲骰即成功。</p>
          <p>每次檢定約耗時<strong>一刻時間</strong>；同一地點尋找同一物只有一次嘗試機會。多個 PC 可在同地同時尋找同一東西。</p>
        `}
      ]
    },
    "魅力技能":{
      theme:"cha",
      items:[
        {name:"交易（魅力）", html:`<p>購買或販賣時，你可進行<strong>交易</strong>檢定嘗試議價。成功：價格±20%；大成功：價格減半/加倍；大失敗：嚴重冒犯對方、交易破局。</p>`},
        {name:"欺瞞（魅力）", html:`<p>快速編出可信的謊言。若 GM 認為內容不夠可信，你的檢定有劣勢；若完全無法讓人信服，則自動失敗。</p>`},
        {name:"表演（魅力）", html:`<p>當你唱歌、吟詩、說笑話或其他取悅群眾的行動時，進行<strong>表演</strong>檢定。</p>`},
        {name:"遊說（魅力）", html:`
          <p>在不使用暴力的情況下，透過誘惑、威脅或講道理來達成目標時，進行<strong>遊說</strong>檢定。成功則 NPC 依你所言行事，可能要求回報（由 GM 決定）。</p>
          <p>若你的要求會讓 NPC 犧牲或賭上重要事物，檢定會更困難，並改為你的<strong>遊說</strong>對抗對方的<strong>意志</strong>。無論多成功，NPC 不會做出違抗其意志的行為（由 GM 裁決）。</p>
          <p>你無法遊說怪物，除非另有說明。</p>
        `}
      ]
    }
  };

  const groupsWrap = document.getElementById('skillGroups');
  const detail = document.getElementById('skillDetail');

  // 生成分組與按鈕（按鈕主題色依屬性）
  Object.keys(data).forEach((groupName, gi)=>{
    const group = data[groupName];

    // 分組標題
    const title = document.createElement('div');
    title.className = 'group-title';
    title.textContent = groupName;

    // 按鈕列
    const list = document.createElement('div');
    list.className = 'skill-tabs';
    group.items.forEach((item, i)=>{
      const btn = document.createElement('button');
      btn.className = `skill-btn btn-${group.theme}`;
      btn.textContent = item.name;
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.skill-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        gsap.to(detail,{opacity:0,duration:.25,onComplete:()=>{
          detail.innerHTML = `<h2>${item.name}</h2>${item.html}`;
          gsap.fromTo(detail,{opacity:0},{opacity:1,duration:.35});
        }});
      });
      list.appendChild(btn);
    });

    // 展開/收合分組；打開時自動挑第一個
    title.addEventListener('click', ()=>{
      const isOpen = list.classList.toggle('active');
      if(isOpen){
        // 關閉其他分組
        document.querySelectorAll('.skill-tabs').forEach(el=>{ if(el!==list) el.classList.remove('active'); });
        // 預設選第一個
        const firstBtn = list.querySelector('.skill-btn');
        if(firstBtn){
          firstBtn.click();
        }
        gsap.fromTo(list,{opacity:0,y:-8},{opacity:1,y:0,duration:.25});
      }
    });

    groupsWrap.appendChild(title);
    groupsWrap.appendChild(list);

    // 預設打開第一組
    if(gi===0){
      list.classList.add('active');
      setTimeout(()=>{ const fb=list.querySelector('.skill-btn'); fb && fb.click(); }, 0);
    }
  });

  // 進場動畫
  window.addEventListener('load', ()=>{
    gsap.to('header',{opacity:1,y:0,duration:1});
    gsap.to('main',{opacity:1,y:0,duration:1.2,delay:.3});
    gsap.to('.gear-tabs',{opacity:1,y:0,duration:.6,delay:.5});
  });
  </script>
</body>
</html>
